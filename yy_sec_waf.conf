#yy_sec_waf off;

#http_method GET POST;

#denied_url "/redirect";

#####
#xss attack IDs:1000-1099
#####

#1.-------------------------------------------------------------------------------------------------
#p1
#basic_rule regex:<(script|iframe|style|applet|base|body|frame|frameset|form|input|ins|layer|link|meta|object|address|area|bgsound|textarea)[^>]*> msg:test pos:ARGS gids:XSS lev:LOG|BLOCK;
#p2
#basic_rule regex:<(s(cript|tyle)|i(frame|n(put|s))|f(rame(set)?|orm)|a(pplet|ddress|rea)|b(ase|gsound|ody)|l(ayer|ink)|meta|object|textarea)[^>]*> msg:test pos:ARGS gids:XSS lev:LOG|BLOCK;
#p3
basic_rule id:1001 regex:<(?:s(?:cript|tyle)|i(?:frame|n(?:put|s))|f(?:rame(?:set)?|orm)|a(?:pplet|ddress|rea)|b(?:ase|gsound|ody)|l(?:ayer|ink)|meta|object|textarea)[^>]*> msg:test pos:ARGS gids:XSS lev:LOG;

#2.---------------------------------------------------------------------------------------------------
#p1
#basic_rule regex:[\s`'"]on(abort|blur|change|click|dblclick|dragdrop|error|focus|keydown|keypress|keyup|load|mousedown|mousemove|mouseout|mouseover|mouseup|move|readystatechange|reset|resize|select|submit|unload)\s*= msg:test pos:ARGS gids:XSS lev:LOG|BLOCK;
#p2
#basic_rule regex:[\s`'"]on(abort|blur|c(hange|lick)|d(blclick|ragdrop)|error|focus|key(down|press|up)|load|m(ouse(down|move|o(ut|ver)|up)|ove)|re(adystatechange|s(et|ize))|s(elect|ubmit)|unload)\s*= msg:test pos:ARGS gids:XSS lev:LOG|BLOCK;
#p3
basic_rule id:1002 regex:[\s`'"]on(?:abort|blur|c(?:hange|lick)|d(?:blclick|ragdrop)|error|focus|key(?:down|press|up)|load|m(?:ouse(?:down|move|o(?:ut|ver)|up)|ove)|re(?:adystatechange|s(?:et|ize))|s(?:elect|ubmit)|unload)\s*= msg:test pos:ARGS gids:XSS lev:LOG;


#3.--------------------------------------------------------------------------------------------------
#p1,p2
#basic_rule regex:[\s`'"]+style\s*=[^:]*:\s*(url|expression) msg:test pos:ARGS gids:XSS lev:LOG|BLOCK;
#p3
basic_rule id:1003 regex:[\s`'"]+style\s*=[^:]*:\s*(?:url|expression) msg:test pos:ARGS gids:XSS lev:LOG;

#union of 2,3
#basic_rule regex:[\s`'"]+(on(abort|blur|c(hange|lick)|d(blclick|ragdrop)|error|focus|key(down|press|up)|load|m(ouse(down|move|o(ut|ver)|up)|ove)|re(adystatechange|s(et|ize))|s(elect|ubmit)|unload)\s*=|style\s*=[^:]*:\s*(url|expression)) msg:test pos:ARGS gids:XSS lev:LOG|BLOCK;

#4.--------------------------------------------------------------------------------------------------
#p1,p2
#basic_rule "regex:((j|&#x[46]a;)(a|&#x[46]1;)(v|&#x[57]6;)(a|&#x[46]1;)|(v|&#x[57]6;)(b|&#x[46]2;))(s|&#x[57]3;)(c|&#x[46]3;)(r|&#x[57]2;)(i|&#x[46]9;)(p|&#x[57]0;)(t|&#x[57]4;)(:|&#x3a;)|(d|&#x[46]4;)(a|&#x[46]1;)(t|&#x[57]4;)(a|&#x[46]1;)(:|&#x3a;)(t|&#x[57]4;)(e|&#x[46]5;)(x|&#x[57]8;)(t|&#x[57]4;)(/|&#x2f;)(h|&#x[46]8;)(t|&#x[57]4;)(m|&#x[46]d;)(l|&#x[46]c;)" msg:test pos:ARGS gids:XSS lev:LOG|BLOCK;
#p3
basic_rule id:1004 "regex:(?:(?:j|&#x[46]a;)(?:a|&#x[46]1;)(?:v|&#x[57]6;)(?:a|&#x[46]1;)|(?:v|&#x[57]6;)(?:b|&#x[46]2;))(?:s|&#x[57]3;)(?:c|&#x[46]3;)(?:r|&#x[57]2;)(?:i|&#x[46]9;)(?:p|&#x[57]0;)(?:t|&#x[57]4;)(?::|&#x3a;)|(?:d|&#x[46]4;)(?:a|&#x[46]1;)(?:t|&#x[57]4;)(?:a|&#x[46]1;)(?::|&#x3a;)(?:t|&#x[57]4;)(?:e|&#x[46]5;)(?:x|&#x[57]8;)(?:t|&#x[57]4;)(?:/|&#x2f;)(?:h|&#x[46]8;)(?:t|&#x[57]4;)(?:m|&#x[46]d;)(?:l|&#x[46]c;)" msg:test pos:ARGS gids:XSS lev:LOG;

#basic_rule regex:(?:java|vb)script:|data:text/html msg:test pos:ARGS gids:XSS lev:LOG|BLOCK;

#5.---------------------------------------------------------------------------------------------------
#p1,p2
#basic_rule "regex:[\"']\s*(/\*.*?\*/)?\s*;.+(\"|'|//|/\*|<!--)" msg:test pos:ARGS gids:XSS lev:LOG|BLOCK;
#p3
basic_rule id:1005 "regex:[\"']\s*(?:/\*.*?\*/)?\s*;.+(?:\"|'|//|/\*|<!--)" msg:test pos:ARGS gids:XSS lev:LOG;

basic_rule id:1006 regex:/\*.*?\*/ msg:test pos:ARGS gids:XSS lev:LOG;
#6.---------------------------------------------------------------------------------------------------
#p1,p2,p3
basic_rule id:1007 regex:[<\s`'"].*?\x00[^=>]*[=>] msg:test pos:ARGS gids:XSS lev:LOG;

#7.--------------------------------------------------------------------------------------------------
#p1,p2
#basic_rule "regex:['\"]\s*\)\s*;.*?(\(.*?['\"]|//|<!--|/\*)" msg:test pos:ARGS gids:XSS lev:LOG|BLOCK;
#p3
basic_rule id:1008 "regex:['\"]\s*\)\s*;.*?(?:\(.*?['\"]|//|<!--|/\*)" msg:test pos:ARGS gids:XSS lev:LOG;

#union 5,7
#basic_rule "regex:[\"']\s*((/\*.*?\*/)?\s*;.+(\"|'|//|/\*|<!--)|\)\s*;.*?(\(.*?['\"]|//|<!--|/\*))" msg:test pos:ARGS gids:XSS lev:LOG|BLOCK;

#8.--------------------------------------------------------------------------------------------------
#p1,p2,p3
basic_rule id:1009 regex:allowScriptAccess[\s]*?=[\s]*?always msg:test pos:ARGS gids:XSS lev:LOG;

##################
#command injection IDs:1100-1199
##################
basic_rule id:1101 "regex:[;\|`&]\W*?\b(?:c(?:h(?:grp|mod|own|sh)|url|pp|c|d|at)|p(?:asswd|ython|erl|ing|s)|n(?:asm|et|map|c)|f(?:inger|tp)|t(?:elnet|raceroute|clsh8?|ftp)|g(?:cc|\+\+)|kill|mail|(?:xte)?rm|ls(?:of)?|id|echo|uname|wget|sh)\b" msg:test pos:ARGS gids:XSS lev:LOG;


##################
# file upload IDs:1200-1299
##################
basic_rule id:1201 gids:UPLOAD mod:on regex:\.\./ msg:"special file charactors" pos:BODY lev:LOG;

basic_rule id:1202 gids:UPLOAD mod:on msg:"uncommon hex encoding, null bytes" pos:BODY lev:LOG;

basic_rule id:1203 gids:UPLOAD mod:on regex:\.jsp|\.php|\.html|\.htm msg:"uncommon filename postfix" pos:BODY  Lev:LOG;

basic_rule id:1204 gids:UPLOAD mod:on msg:"uncommon filename" pos:BODY lev:LOG;


#################
#sql injection IDs:1300-1399
#################
#basic_rule id:1300  msg:redirect_4xx_and_5xx pos:ARGS gids:SQL lev:LOG;

#basic_rule id:1301 regex:=(0x)?[0-9a-f]+\s+(and|or|&&|\|\|)(\s(0x)?[0-9a-f]+|[^&]{1,13}[=><]) msg:test pos:ARGS gids:SQL lev:LOG;

basic_rule id:1302 regex:=[^'"]*['"]\s+(and|or|&&|\|\|)\s*(['"][^'"]*['"]\s*[=><]\s*['"]|(0x)?[0-9a-f]+[^\#-&]*(\#|--)) msg:test pos:ARGS gids:SQL lev:LOG;

basic_rule id:1303 regex:\b(((order|group)\s+by|mysql\s*\.\s*(user|db|tables_priv|columns_priv)|current_user)\b|in(to\s+(outfile|dumpfile)\b|(formation_schema\s*\.))) msg:test pos:ARGS gids:SQL lev:LOG;

basic_rule id:1304 regex:\b(ascii|benchmark|c(har|oncat)|database|group_concat|if|l(ength|oad_file)|s(ystem_user|ubstr(ing)?|leep)|user|version)\s*\( msg:test pos:ARGS gids:SQL lev:LOG;

#basic_rule id:1305 regex:\b(case\s+when|union.{1}{20}select|select\b.{1}{50}\bfrom)\b msg:test pos:ARGS gids:SQL lev:LOG;

basic_rule id:1306 regex:@@(version|datadir) msg:test pos:ARGS gids:SQL lev:LOG;

#basic_rule id:1307 regex:/\*.{0,50}\*/ msg:test pos:ARGS gids:SQL lev:LOG;

#basic_rule id:1308 regex:\b(insert\s*into\b .*\bvalues|update\s+\w+\s+set|delete\s+from|(CREATE|DROP)\s+(DATABASE|TABLE))\b msg:test pos:ARGS gids:SQL lev:LOG;


